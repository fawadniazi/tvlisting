(function(){var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],t=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,n=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,r=typeof location!="undefined"&&location.href,i=r&&location.protocol&&location.protocol.replace(/\:/,""),s=r&&location.hostname,o=r&&(location.port||void 0),u=[];define("libs/text",[],function(){var a,f,l;return typeof window!="undefined"&&window.navigator&&window.document?f=function(e,t){var n=a.createXhr();n.open("GET",e,!0),n.onreadystatechange=function(){n.readyState===4&&t(n.responseText)},n.send(null)}:typeof process!="undefined"&&process.versions&&process.versions.node?(l=require.nodeRequire("fs"),f=function(e,t){t(l.readFileSync(e,"utf8"))}):typeof Packages!="undefined"&&(f=function(e,t){var n=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),n=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(n),"utf-8")),i,s,o="";try{i=new java.lang.StringBuffer,(s=n.readLine())&&s.length()&&s.charAt(0)===65279&&(s=s.substring(1));for(i.append(s);(s=n.readLine())!==null;)i.append(r),i.append(s);o=String(i.toString())}finally{n.close()}t(o)}),a={version:"0.27.0",strip:function(e){if(e){var e=e.replace(t,""),r=e.match(n);r&&(e=r[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var t,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(n=0;n<3;n++){r=e[n];try{t=new ActiveXObject(r)}catch(i){}if(t){e=[r];break}}if(!t)throw Error("createXhr(): XMLHttpRequest not available");return t},get:f,parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),e=e.substring(n+1,e.length),n=e.indexOf("!");return n!==-1&&(t=e.substring(n+1,e.length),t=t==="strip",e=e.substring(0,n)),{moduleName:r,ext:e,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,r){var i=a.xdRegExp.exec(e),s;return i?(e=i[2],i=i[3],i=i.split(":"),s=i[1],i=i[0],(!e||e===t)&&(!i||i===n)&&(!s&&!i||s===r)):!0},finishLoad:function(e,t,n,r,i){n=t?a.strip(n):n,i.isBuild&&i.inlineText&&(u[e]=n),r(n)},load:function(e,t,n,u){var f=a.parseName(e),l=f.moduleName+"."+f.ext,c=t.toUrl(l),h=u&&u.text&&u.text.useXhr||a.useXhr;!r||h(c,i,s,o)?a.get(c,function(t){a.finishLoad(e,f.strip,t,n,u)}):t([l],function(e){a.finishLoad(f.moduleName+"."+f.ext,f.strip,e,n,u)})},write:function(e,t,n){if(t in u){var r=a.jsEscape(u[t]);n.asModule(e+"!"+t,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,t,n,r,i){var t=a.parseName(t),s=t.moduleName+"."+t.ext,o=n.toUrl(t.moduleName+"."+t.ext)+".js";a.load(s,n,function(){var t=function(e){return r(o,e)};t.asModule=function(e,t){return r.asModule(e,o,t)},a.write(e,s,t,i)},i)}}})})(),define("libs/text!template/app.tpl",[],function(){return"{{outlet}}"}),define("helper/utils",[],function(){var e={};return e.getWidth=function(){return $(window).width()},e.xmlToJson=function(e){var t={};if(e.nodeType==1){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var r=e.attributes.item(n);t["@attributes"][r.nodeName]=r.nodeValue}}}else e.nodeType==3&&(t=e.nodeValue);if(e.hasChildNodes())for(var i=0;i<e.childNodes.length;i++){var s=e.childNodes.item(i),o=s.nodeName;if(typeof t[o]=="undefined")t[o]=this.xmlToJson(s);else{if(typeof t[o].length=="undefined"){var u=t[o];t[o]=[],t[o].push(u)}t[o].push(this.xmlToJson(s))}}return t},e}),define("helper/app",["libs/text!template/app.tpl","helper/utils"],function(e,t){return window.App=window.App||Em.Application.create(),App.ApplicationController=Em.Controller.extend({baseURL:"https://img-upload.s3.amazonaws.com/",tempArr:[],fetchSmall:function(){var e=this;$.ajax({type:"GET",url:e.baseURL,data:{prefix:"small/",marker:"small"},success:function(n){var r=t.xmlToJson(n);e.reOrg(r);var i=e.reOrg(r);console.log(i),i=e.truncate(i),App.router.get("mobileController").set("content",i),Em.run.next(this,function(){e.appear()})}})},fetchMedium:function(){var e=this;$.ajax({type:"GET",url:e.baseURL,data:{prefix:"small/",marker:"small"},success:function(n){var r=t.xmlToJson(n);e.reOrg(r);var i=e.reOrg(r);console.log(i),i=e.splitTwo(i),i=e.truncate(i),App.router.get("desktopController").set("content",i),Em.run.next(this,function(){e.appear()})}})},reOrg:function(e){var t=[],n=_.pluck(e,"Contents")[0],r=this;t=r.modifyInfo(n);var i=_.groupBy(t.reverse(),function(e){return e.prettyDay});return i=_.sortBy(i,function(e){return e[0].date}),i=_.map(i,function(e){var t={};return t.arr=e,t.prettyDay=moment(e[0].date).format("MMM Do"),t}),i.reverse()},modifyInfo:function(e){var t=this,n=[];return _.each(e,function(e,r){if(r){var i={};i.date=e.LastModified["#text"],i.prettyDay=moment(i.date).format("MMM Do YY"),i.prettyTime=moment(i.date).format("hh:mm a"),i.imgSrc=t.baseURL+e.Key["#text"],i.original=t.baseURL+e.Key["#text"].replace("small/","medium/"),n.push(i)}}),n},splitTwo:function(e){return _.each(e,function(e){var t=[],n=[];_.each(e.arr,function(e,r){r%2?t.push(e):n.push(e)}),e.arrLeft=t,e.arrRight=n}),e},sharePics:function(e){var t=this;return FB.ui({method:"feed",link:"http://google.com",picture:$(e.currentTarget).attr("data-img"),name:"Travel the World"},function(e){typeof e!="undefined"&&alert("Image shared!")}),!1},startBindings:function(){$(window).resize(function(){t.getWidth()>=940?App.router.transitionTo("desktop.index"):App.router.transitionTo("mobile.index")})},appear:function(){var e=200;$(".pics").one("load",function(){$(this).parents(".li-wrapper").addClass("loaded"),$(this).parents(".li-wrapper").css({opacity:"1","-webkit-transform":"translateY(0px)"})}).each(function(){this.complete&&$(this).load()})},truncate:function(e){var t=[];return e.length>2?(t=[e[0],e[1]],App.router.get("applicationController").tempArr=_.reject(e,function(e,t){return t===0||t===1}),console.log(e),console.log(t),console.log(App.router.get("applicationController").tempArr)):e.length&&(App.router.get("applicationController").tempArr=[],t=e,$(".load-rest").css("display","none")),t}}),App.ApplicationView=Em.View.extend({template:Em.Handlebars.compile(e),didInsertElement:function(){this.get("controller").startBindings()}}),App}),define("libs/text!template/desktop.tpl",[],function(){return'<div class="container">\n	<div class="row">\n		<div class="span12 mobile-header">\n			<img src="img/mobile-header.png">\n		</div>\n	</div>\n	<div id="desktop-view" class="row">\n		{{#each content}}\n			<p class="l-date"><span>{{prettyDay}}</span> <img src="img/date-bg.png"></p>\n			<div class="l-two-list">\n				<ul class="list-left">\n					{{#each arrLeft}}\n						<li class="l-li">\n							<p class="time"><span>{{prettyTime}}</span> <img src="img/dot.png"></p>\n							<div class="li-wrapper">\n								<img class="l-mobile-pic pics" {{bindAttr src="imgSrc"}}>\n								<img class="l-pic-shadow" src="img/pic-shadow.png">\n								<div class="toolbar">\n									<div class="toolbar-wrapper">\n										<a class="download" href="{{unbound original}}" target="_blank">Download</a>\n										<a href="#" class="share" {{bindAttr data-img="imgSrc"}} {{action sharePics target="view.parentView.parentView.controller"}}>Share</a>\n									</div>\n								</div>\n							</div>\n						</li>\n					{{/each}}\n				</ul>\n				<ul class="list-right">\n					{{#each arrRight}}\n						<li class="l-li">\n							<p class="time"><span>{{prettyTime}}</span> <img src="img/dot.png"></p>\n							<div class="li-wrapper">\n								<img class="l-mobile-pic pics" {{bindAttr src="imgSrc"}}>\n								<img class="l-pic-shadow" src="img/pic-shadow.png">\n								<div class="toolbar">\n									<div class="toolbar-wrapper">\n										<a class="download" href="{{unbound original}}" target="_blank">Download</a>\n										<a href="#" class="share" {{bindAttr data-img="imgSrc"}} {{action sharePics target="view.parentView.parentView.controller"}}>Share</a>\n									</div>\n								</div>\n							</div>\n						</li>\n					{{/each}}\n\n				</ul>\n			</div>\n		{{/each}}\n		<ul class="load-rest">\n			<li><a class="btn" href="#" {{action loadRest target="view"}}>Load Earlier Pictures</a></li>\n		</ul>\n	</div>\n</div><!-- container -->'}),define("helper/desktop",["helper/app","libs/text!template/desktop.tpl"],function(e,t){e.DesktopController=Em.Controller.extend(),e.DesktopView=Em.View.extend({template:Em.Handlebars.compile(t),didInsertElement:function(){e.router.get("applicationController").fetchMedium()},loadRest:function(){var t=e.router.get("applicationController").tempArr;t=e.router.get("applicationController").truncate(t),this.get("controller").get("content").addObjects(t),Em.run.next(this,function(){e.router.get("applicationController").appear()})}})}),define("libs/text!template/mobile.tpl",[],function(){return'<div class="container-fluid">\n	<div class="row-fluid">\n		<div class="span12 mobile-header">\n			<img src="img/mobile-header.png">\n		</div>\n	</div>\n	<div class="row-fluid">\n		<div class="span12">\n			<div class="mobile-timeline">\n			{{#each content}}\n				<p class="l-date"><span>{{prettyDay}}</span> <img src="img/date-bg.png"></p>\n				<ul class="l-one-list">\n					{{#each arr}}\n					<li class="l-li">\n						<p class="time"><span>{{prettyTime}}</span> <img src="img/dot.png"></p>\n						<div class="li-wrapper">\n							<img class="l-mobile-pic pics" {{bindAttr src="imgSrc"}}>\n							<img class="l-pic-shadow" src="img/pic-shadow.png">\n							<div class="toolbar">\n								<div class="toolbar-wrapper">\n									<a class="download" href="{{unbound original}}" target="_blank">Download</a>\n									<a href="#" class="share" {{bindAttr data-img="imgSrc"}} {{action sharePics target="view.parentView.parentView.controller"}}>Share</a>\n								</div>\n							</div>\n						</div>\n					</li>\n					{{/each}}\n 			</ul>\n 			{{/each}}\n 			<ul class="load-rest">\n 				<li><a class="btn" href="#" {{action loadRest target="view"}}>Load Earlier Pictures</a></li>\n 			</ul>\n 			<div class="timeline l-timeline"></div>\n 			</div>\n		</div>\n	</div>\n</div><!-- container -->'}),define("helper/mobile",["helper/app","libs/text!template/mobile.tpl"],function(e,t){e.MobileController=Em.Controller.extend(),e.MobileView=Em.View.extend({template:Em.Handlebars.compile(t),didInsertElement:function(){e.router.get("applicationController").fetchSmall()},loadRest:function(){var t=e.router.get("applicationController").tempArr;t=e.router.get("applicationController").truncate(t),this.get("controller").get("content").addObjects(t),Em.run.next(this,function(){e.router.get("applicationController").appear()})}})}),require(["helper/app","helper/utils","helper/desktop","helper/mobile"],function(e,t){var n=Em.Router.create({enableLogging:!1,root:Em.Route.extend({index:Em.Route.extend({route:"/",connectOutlets:function(e){t.getWidth()>=940?e.transitionTo("desktop.index"):e.transitionTo("mobile.index")}}),desktop:Em.Route.extend({route:"/desktop",index:Ember.Route.extend({route:"/",connectOutlets:function(e){t.getWidth()<=940?e.transitionTo("mobile.index"):e.get("applicationController").connectOutlet("desktop")}})}),mobile:Em.Route.extend({route:"/mobile",index:Ember.Route.extend({route:"/",connectOutlets:function(e){t.getWidth()>=940?e.transitionTo("desktop.index"):e.get("applicationController").connectOutlet("mobile")},move:Em.Route.transitionTo("root")})})})});e.initialize(n)}),define("main",function(){})